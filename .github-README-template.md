# ğŸšš Cliente-Core - MicroserviÃ§o de GestÃ£o de Clientes

[![Java](https://img.shields.io/badge/Java-21-orange.svg)](https://openjdk.org/projects/jdk/21/)
[![Spring Boot](https://img.shields.io/badge/Spring%20Boot-3.5.7-brightgreen.svg)](https://spring.io/projects/spring-boot)
[![PostgreSQL](https://img.shields.io/badge/PostgreSQL-16-blue.svg)](https://www.postgresql.org/)
[![DynamoDB](https://img.shields.io/badge/Cache-DynamoDB-yellow.svg)](https://aws.amazon.com/dynamodb/)
[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)

MicroserviÃ§o responsÃ¡vel pelo **CRUD completo de clientes PF/PJ** com cache DynamoDB, auditoria, e documentaÃ§Ã£o OpenAPI.

---

## âš¡ Quick Start

### Setup Local em 1 Comando

```bash
cd cliente-core
./setup-local.sh
```

**Isso vai automaticamente:**
- âœ… Validar dependÃªncias (Java 21+, Maven, Docker)
- âœ… Subir PostgreSQL + DynamoDB Local
- âœ… Criar tabela de cache
- âœ… Buildar aplicaÃ§Ã£o
- âœ… Rodar smoke tests
- âœ… Mostrar URLs Ãºteis

**Tempo:** ~2 minutos â±ï¸

---

## ğŸ“š DocumentaÃ§Ã£o

- **[Quick Start](README-QUICK-START.md)** - Setup em 1 comando
- **[Setup Detalhado](COMO_SUBIR_LOCAL_STACK.md)** - Guia completo local
- **[README Principal](README.md)** - DocumentaÃ§Ã£o tÃ©cnica completa
- **[Guia Claude](CLAUDE.md)** - ConvenÃ§Ãµes e arquitetura

---

## ğŸ—ï¸ Arquitetura

- **Pattern:** Hexagonal Architecture (Ports & Adapters)
- **Database:** PostgreSQL 16 (JPA/Hibernate)
- **Cache:** DynamoDB Local (dev) â†’ AWS DynamoDB (prod)
- **Migrations:** Liquibase com contexts
- **Testing:** JUnit 5 + Mockito + TestContainers
- **Coverage:** 80%+ (JaCoCo)

---

## ğŸš€ Features

- âœ… CRUD completo ClientePF e ClientePJ
- âœ… HeranÃ§a JPA JOINED strategy
- âœ… Cache DynamoDB (Free Tier MVP)
- âœ… ~50 Ã­ndices otimizados PostgreSQL
- âœ… Auditoria de alteraÃ§Ãµes crÃ­ticas
- âœ… LGPD compliance (PreferenciaCliente)
- âœ… Structured logging (JSON em prod)
- âœ… OpenAPI/Swagger UI
- âœ… Health checks + Metrics (Actuator)

---

## ğŸ› ï¸ Tech Stack

| Categoria | Tecnologia |
|-----------|-----------|
| **Language** | Java 21 (Virtual Threads) |
| **Framework** | Spring Boot 3.5.7 |
| **Database** | PostgreSQL 16 |
| **Cache** | DynamoDB (Free Tier) |
| **Migrations** | Liquibase |
| **Testing** | JUnit 5, Mockito, TestContainers |
| **Build** | Maven 3.9+ |
| **Observability** | Micrometer, Prometheus, Actuator |
| **Logging** | SLF4J + Logback (JSON) |
| **Docs** | OpenAPI 3.0 |

---

## ğŸ“Š Performance

| OperaÃ§Ã£o | LatÃªncia | Cache |
|----------|----------|-------|
| GET /clientes/pf/{id} (cache MISS) | ~60ms | âŒ |
| GET /clientes/pf/{id} (cache HIT) | ~15ms | âœ… |
| **Melhoria** | **75%** | âš¡ |

---

## ğŸ—„ï¸ Modelo de Dados

```
Cliente (abstract)
â”œâ”€â”€ ClientePF (CPF, RG, data nascimento, etc.)
â””â”€â”€ ClientePJ (CNPJ, razÃ£o social, inscriÃ§Ã£o estadual, etc.)
    â”œâ”€â”€ Documento (CPF, RG, CNH, etc.)
    â”œâ”€â”€ Contato (telefone, email, WhatsApp, etc.)
    â”œâ”€â”€ Endereco (residencial, comercial, entrega)
    â”œâ”€â”€ DadosBancarios (PIX, conta principal)
    â”œâ”€â”€ PreferenciaCliente (LGPD compliance)
    â””â”€â”€ AuditoriaCliente (log de alteraÃ§Ãµes)
```

---

## ğŸ”§ Comandos Ãšteis

```bash
# ApÃ³s setup-local.sh
./local-dev.sh status       # Ver status dos serviÃ§os
./local-dev.sh test-cache   # Testar cache em detalhes
./local-dev.sh stop         # Parar tudo
./local-dev.sh logs         # Ver logs containers
```

---

## ğŸ“ Exemplos de API

```bash
# Listar clientes PF
curl http://localhost:8081/api/clientes/v1/clientes/pf | jq

# Buscar por ID
curl http://localhost:8081/api/clientes/v1/clientes/pf/{uuid} | jq

# Health check
curl http://localhost:8081/api/clientes/actuator/health | jq

# Swagger UI
open http://localhost:8081/api/clientes/swagger-ui
```

---

## ğŸ§ª Testing

```bash
# Rodar todos os testes
mvn test

# Rodar com coverage
mvn clean verify

# Ver relatÃ³rio JaCoCo
open target/site/jacoco/index.html
```

---

## ğŸš¢ Deploy

### AWS (Production)

```bash
# Definir profile
export SPRING_PROFILES_ACTIVE=prod

# VariÃ¡veis de ambiente obrigatÃ³rias
export AWS_REGION=us-east-1
export DB_HOST=rds-endpoint.amazonaws.com
export DB_PASSWORD=<secure-password>

# Rodar aplicaÃ§Ã£o
java -jar target/cliente-core-0.0.1-SNAPSHOT.jar
```

**Infraestrutura AWS:**
- RDS PostgreSQL 16 (Multi-AZ)
- DynamoDB (Free Tier â†’ OnDemand)
- IAM Role com policies mÃ­nimas
- Security Groups (portas 5432, 8081)

---

## ğŸ“ˆ Roadmap

- [ ] Swagger UI completo
- [ ] Redis cache (post Month 3-6)
- [ ] OAuth2 + JWT authentication
- [ ] Rate limiting
- [ ] Circuit breaker (Resilience4j)
- [ ] Distributed tracing (Zipkin/Jaeger)

---

## ğŸ¤ Contribuindo

1. Clone o repo
2. Crie branch: `git checkout -b feature/minha-feature`
3. Commit: `git commit -m 'feat: adiciona feature X'`
4. Push: `git push origin feature/minha-feature`
5. Abra Pull Request

**ConvenÃ§Ãµes:**
- Commits: [Conventional Commits](https://www.conventionalcommits.org/)
- Cobertura: â‰¥80% (obrigatÃ³rio)
- Code review: 1 aprovaÃ§Ã£o mÃ­nima

---

## ğŸ“„ License

MIT License - veja [LICENSE](LICENSE) para detalhes.

---

## ğŸ‘¥ Time

Desenvolvido com â¤ï¸ pela equipe **Va Nessa MudanÃ§a**.

---

## ğŸ“ Suporte

- ğŸ“§ Email: dev@vanessamudanca.com.br
- ğŸ“– Docs: [Wiki Interna](https://wiki.vanessamudanca.com.br)
- ğŸ› Issues: [GitHub Issues](https://github.com/vanessa-mudanca/va-nessa-mudanca/issues)
